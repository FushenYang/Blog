---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";

const books = await getCollection('books');
const sortedBooks = books.sort((a, b) => {
  const dateA = new Date(a.data.pubDate).getTime();
  const dateB = new Date(b.data.pubDate).getTime();
  return dateB - dateA;
});
const latestBooks = sortedBooks.slice(0, 3);
const renderedBooks = await Promise.all(
  latestBooks.map(async (book) => {
    const { Content } = await book.render();
    return { ...book, Content };
  })
);

---

<Layout title="oldyang的博客首页">
  {renderedBooks.map((book) => (

      <span class="text-2xl mb-4">{book.data.title}</span>
      <div>
        <book.Content />
      </div>

  ))}
</Layout>
